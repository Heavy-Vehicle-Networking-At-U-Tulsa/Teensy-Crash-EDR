<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Teensy 3.2 based Crash Event Data Recorder by jeremy-daily</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/github-light.css">
    <meta name="viewport" content="width=device-width">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>Teensy 3.2 based Crash Event Data Recorder</h1>
        <p>A Teensy 3.2 based through hole project that includes CAN, SD, an ADXL375 High G triaxial accelerometer for use in traffic crash testing</p>

        <p class="view"><a href="https://github.com/jeremy-daily/Teensy-Crash-EDR">View the Project on GitHub <small>jeremy-daily/Teensy-Crash-EDR</small></a></p>


        <ul>
          <li><a href="https://github.com/jeremy-daily/Teensy-Crash-EDR/zipball/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/jeremy-daily/Teensy-Crash-EDR/tarball/master">Download <strong>TAR Ball</strong></a></li>
          <li><a href="https://github.com/jeremy-daily/Teensy-Crash-EDR">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
        <h1>
<a id="teensy-crash-edr" class="anchor" href="#teensy-crash-edr" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Teensy-Crash-EDR</h1>

<p>A Teensy 3.2 based through hole project that includes CAN, SD, an ADXL375 High G triaxial accelerometer, an AdaFruit Ultimate GPS breakout, An ESP</p>

<h2>
<a id="project-purpose" class="anchor" href="#project-purpose" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Project Purpose</h2>

<p>The goal of this project is to design and share an open source data acquisition device that can be used for vehicle crash testing. The crash tests
considered are typically done at crash reconstruction conferences or trainig events where law enforcement and private crash investigators
gather to witness a crash and solidify their understanding of the dynamics involved with such an event. </p>

<p>Additionally, a light version (the one without the sensors) is designed to be used in training on Controller Area Networks and J1939.</p>

<h2>
<a id="hardware-features" class="anchor" href="#hardware-features" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Hardware Features</h2>

<ul>
<li>Microprocessor: Teensy 3.2 32-bit ARM-Cortex M4 Arduino compatible microprocessor board</li>
<li>MicroSD Card for storage (Tested to log data at 4000Hz)</li>
<li>GPS: Adafruit Ultimate GPS capable of 10Hz update rates</li>
<li>High Speed CAN (1Mbps) capable of processing 100% bus load</li>
<li>Real Time Clock</li>
<li>High G Tri-axial accelerometer (+/- 200G)</li>
<li>Low G Tri-axial Accelerometer</li>
<li>Tri-axial Rate Gyro</li>
<li>Tri-axial Magnetometer</li>
<li>Battery Powered (Charges with USB)</li>
<li>Wi-Fi Capable (Internet of Things)</li>
<li>7-36 VDC input with reverse polarity protection</li>
<li>Open source design and easily obtainable parts (See Hardware and Schematics directory)</li>
<li>Low cost</li>
<li>All through hole parts so it can be easily hand soldered.</li>
</ul>

<h2>
<a id="learning-to-write-software" class="anchor" href="#learning-to-write-software" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Learning to Write Software</h2>

<p>The idea of this project is to enable students to start from the beginning and succeed with little or no previous experience with writing code for embedded processors.
There are a couple of prerequisites: </p>

<ol>
<li>Arduino software (the code was developed and tested with version 1.6.11)</li>
<li>Teensyduino software, which is an extension of Arduino (the code was developed and tested and developed with v1.30)</li>
<li>The SdFat Arduino library
The idea of the code development is to take examples that are close to the functionality of what you are interested in and adapt them to the hardware we have. As such, some of the examples and projects have different
programming styles. This is because those programs extend the code base from different sources. </li>
</ol>

<p>The following sections describe the functional and learning objectives of each of the enumerated examples in this repository. They example programs (sometimes called sketches) are intended to be used in sequence. The assignment is to extend
the functionality of each of the code bases to demonstrate the learning objectives. </p>

<h3>
<a id="lesson-1-blink" class="anchor" href="#lesson-1-blink" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Lesson 1: Blink</h3>

<p>This is a basic program that helps the student understand the process of writing a program and uploading it to the processor to run. The objective is to be able to change the blink rate and see the result.</p>

<p>Assignment: Change the Blink Rate by using an elapsedMillis timer.</p>

<h3>
<a id="lesson-2-receive-can-messages" class="anchor" href="#lesson-2-receive-can-messages" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Lesson 2: Receive CAN messages</h3>

<p>Introduce the FlexCAN library and print the CAN messages to the serial output.</p>

<p>Assignment: Change the output format to be comma separated values</p>

<h3>
<a id="lesson-3-real-time-clock" class="anchor" href="#lesson-3-real-time-clock" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Lesson 3: Real Time Clock</h3>

<p>Add the time keeping libraries so CAN messages can be timestamped with the real time</p>

<p>Assignment: Add the microseconds to each real time stamp. (Hint: You can use an IntervalTimer to reset an elapsedMicros counter every second.)</p>

<h3>
<a id="lesson-4-send-request-messages-for-j1939" class="anchor" href="#lesson-4-send-request-messages-for-j1939" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Lesson 4: Send Request Messages for J1939</h3>

<p>Add the ability to broadcast request messages for different J1939 parameters. Some data is only available upon request.</p>

<p>Assignment: Send requests to different Destination Addresses. Add another PGN to request to the list.</p>

<h3>
<a id="lesson-5-interpret-simple-j1939-messages" class="anchor" href="#lesson-5-interpret-simple-j1939-messages" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Lesson 5: Interpret Simple J1939 Messages</h3>

<p>Using the J1939-71 or J1939-DA interpret some interesting messages, like wheel speed.</p>

<p>Assignment: Add interpreters for a couple other signals of interest (e.g. Engine RPM or Front Axle Speed)</p>

<h3>
<a id="lesson-6-write-data-to-an-sd-card" class="anchor" href="#lesson-6-write-data-to-an-sd-card" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Lesson 6: Write data to an SD Card</h3>

<p>Log all CAN traffic to an SD Card.</p>

<p>Assignment: Send request messages so the responses get logged.</p>

<h2>
<a id="future-work" class="anchor" href="#future-work" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Future Work</h2>

<h3>
<a id="lesson-7-add-gps-data-to-the-sd-log-files-to-be-written" class="anchor" href="#lesson-7-add-gps-data-to-the-sd-log-files-to-be-written" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Lesson 7: Add GPS data to the SD log files (to be written)</h3>

<h3>
<a id="lesson-8-read-sensor-data-to-be-written" class="anchor" href="#lesson-8-read-sensor-data-to-be-written" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Lesson 8: Read Sensor Data (to be written)</h3>

<h3>
<a id="lesson-9-implement-an-extended-kalman-filter-to-be-written" class="anchor" href="#lesson-9-implement-an-extended-kalman-filter-to-be-written" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Lesson 9: Implement an Extended Kalman Filter (to be written)</h3>
      </section>
      <footer>
        <p>This project is maintained by <a href="https://github.com/jeremy-daily">jeremy-daily</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="javascripts/scale.fix.js"></script>
    
  </body>
</html>
